// updateNames.jsrequire('dotenv').config(); // ·ﬁ—«¡… „ €Ì—«  «·»Ì∆… „À· —«»ÿ ﬁ«⁄œ… «·»Ì«‰« const mongoose = require('mongoose');const axios = require('axios');const User = require('./models/User'); // ??  √ﬂœ √‰ Â–« «·„”«— Ìÿ«»ﬁ „ﬂ«‰ „·› User.js ·œÌﬂ// ≈⁄œ«œ«  «·« ’«· »ﬁ«⁄œ… «·»Ì«‰«  (‰”Œ‰« «·—«»ÿ „‰ „·› .env)const connectDB = async () => {    try {        await mongoose.connect(process.env.MONGO_URI); // √Ê ÷⁄ «·—«»ÿ „»«‘—… Â‰« ﬂ”·”·… ‰’Ì… ≈–« ·„ Ì⁄„· .env        console.log('? Connected to MongoDB');    } catch (error) {        console.error('? DB Connection Error:', error);        process.exit(1);    }};// œ«·… „”«⁄œ… ·Ã·» «·«”„ „‰ FPLconst getFplName = async (fplId) => {    try {        const response = await axios.get(`https://fantasy.premierleague.com/api/entry/${fplId}/`);        return `${response.data.player_first_name} ${response.data.player_last_name}`;    } catch (error) {        console.error(`?? Failed to fetch FPL ID: ${fplId}`);        return null;    }};// «·ÊŸÌ›… «·—∆Ì”Ì…const runMigration = async () => {    await connectDB();    try {        console.log('? Fetching users...');        const users = await User.find({ fplId: { $exists: true, $ne: null } }); // Ã·» «·„” Œœ„Ì‰ «·–Ì‰ ·œÌÂ„ FPL ID ›ﬁÿ                console.log(`Found ${users.length} users with FPL ID. Starting update...`);        let updatedCount = 0;        for (const [index, user] of users.entries()) {            // ÿ»«⁄… «· ﬁœ„            process.stdout.write(`Processing user ${index + 1}/${users.length}: ${user.username} -> `);            const realName = await getFplName(user.fplId);            if (realName && realName !== user.username) {                user.username = realName;                await User.updateOne({ _id: user._id }, { $set: { username: realName } });                updatedCount++;                console.log(`? Updated to "${realName}"`);            } else if (!realName) {                console.log(`? Invalid FPL ID`);            } else {                console.log(`??  No change needed`);            }            // ?? Â«„ Ãœ«:  √ŒÌ— »”Ìÿ (200 „·Ì À«‰Ì…) · Ã‰» ÕŸ— IP „‰ „Êﬁ⁄ «·›«‰ «“Ì            await new Promise(resolve => setTimeout(resolve, 200));        }        console.log('-----------------------------------');        console.log(`?? Migration Complete! Updated ${updatedCount} users.`);            } catch (error) {        console.error('? Migration Error:', error);    } finally {        // ≈€·«ﬁ «·« ’«· Ê≈‰Â«¡ «·”ﬂ—»         await mongoose.connection.close();        console.log('DB Connection Closed.');        process.exit();    }};//  ‘€Ì· «·”ﬂ—» runMigration();